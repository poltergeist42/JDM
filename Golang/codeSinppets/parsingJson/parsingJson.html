

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Parsing Json &mdash; JDM</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../search.html" />
    <link rel="next" title="HPVC" href="../../../HPVC.html" />
    <link rel="prev" title="Code Sinppets" href="../codeSinppets.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../../../index.html">
                JDM
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a></li>
        
          <li><a href="../../Golang.html">Golang</a></li>
        
          <li><a href="../codeSinppets.html">Code Sinppets</a></li>
        
      <li>Parsing Json</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../../../_sources/Golang/codeSinppets/parsingJson/parsingJson.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../../../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <p class="caption" role="heading"><span class="caption-text">Sommaire:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">infos générales Journal de manip</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#description">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Composants.html">Composants Spécifiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ComputerVision.html">Computer Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Culture_Gen.html">Culture Générale / Connaissances insolites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../DataBase/DataBase.html">DataBase</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../DataBase/PostGreSQL/PostGreSQL.html">PostGreSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../DataBase/Redis/Redis.html">Redis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Dev_Gest_Prjet/Dev_Gest_Prjet.html">Développement, Gestion  et Commercialisation de projet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Dev_Gest_Prjet/DevProject/DevProject.html">Dévellopement de projet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Dev_Gest_Prjet/Merise/Merise.html">MERISE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Dev_Gest_Prjet/Agile/Agile.html">La méthode Agile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Dev_Gest_Prjet/Commercialisation/Commercialisation.html">Commercialisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Diagrams.html">Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Docker.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Documentation_Automatique.html">Documentation_Automatique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ESP.html">ESP8266 &amp; ESP32</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Freecad.html">Freecad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GIT.html">GIT (versioning)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Golang.html">Golang</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../GetStarted/GetStarted.html">Get Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Syntax/Syntax.html">Détails syntaxiques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vocabGlossary/vocabGlossary.html">Vocabulaire et Glossaire</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../codeSinppets.html">Code Sinppets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../HPVC.html">HPVC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../IDE_TextEditor/IDE_TextEditor.html">IDE &amp; Text Editor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../IDE_TextEditor/Latex/Latex.html">LaTex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../IDE_TextEditor/VIM/VIM.html">VIM (VI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../IDE_TextEditor/visualStudioCode/visualStudioCode.html">Visual Studio Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Informatique.html">Informatique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kicad.html">Kicad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Linux/Linux.html">LINUX</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/shell/shell.html">SHELL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/multiscreen/multiscreen.html">Multi-Screen terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/scripting/scripting.html">Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/UsersGroupsACL/UsersGroupsACL.html">Utilisateurs, Groupes et Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/sysAdmin/sysAdmin.html">Administration Système</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/network/network.html">network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/sharedFolders/sharedFolders.html">Dossiers partager et volumes distants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/hardwareMgnt/hardwareMgnt.html">Hardware Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/Raspberry/Raspberry.html">Raspberry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Linux/bugError/bugError.html">Bug, Maintenance et traitemant des Erreurs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../MAC_OS.html">MAC OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Machine_learning.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../MQTT.html">MQTT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Musique/Musique.html">Musique</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Musique/theorie/theorie.html">Théorie musicale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Musique/MAO/MAO.html">Musique Assistée (par) Ordinateur - MAO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Musique/guitare/guitare.html">Guitare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Musique/GuitareChant/GuitareChant.html">GuitareChant</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Optimisation_Travail.html">Optimisation du travail (et de l’apprentissage)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Powershell.html">PowerShell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Python.html">PYTHON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Regex.html">Regex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Reseau.html">Reseau</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Soudure.html">Soudure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Techno_WEB/Techno_WEB.html">Technos Web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Techno_WEB/HTML_CSS/HTML_CSS.html">HTML_CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Techno_WEB/Javascript/Javascript.html">JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Techno_WEB/React_and_legacy/React_and_legacy.html">React &amp; Legacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Techno_WEB/Node_Express/Node_Express.html">Node &amp; Express</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Techno_WEB/webCreation/webCreation.html">Création de Site Web</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Trading.html">Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../URLtheque.html">URLtheque</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../XML_JSON.html">XML_JSON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../arborescence/arborescence.html">Arborescence du projet</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../deprecated/deprecated.html">Eléments dépréciés</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../deprecated/Aquariophilie/Aquariophilie.html">Aquariophilie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../deprecated/Django/Django.html">Django 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../deprecated/English_vocab/English_vocab.html">English Vocabulary</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <section id="parsing-json">
<h1><a class="toc-backref" href="#sommaire" role="doc-backlink">Parsing Json</a><a class="headerlink" href="#parsing-json" title="Lien permanent vers cette rubrique">¶</a></h1>
<nav class="contents" id="sommaire">
<span id="index-0"></span><p class="topic-title">Sommaire</p>
<ul class="simple">
<li><p><a class="reference internal" href="#parsing-json" id="id1">Parsing Json</a></p>
<ul>
<li><p><a class="reference internal" href="#parsing-json-unstructured-json" id="id2">parsing json : unstructured json</a></p>
<ul>
<li><p><a class="reference internal" href="#json-structure" id="id3">Json Structuré</a></p></li>
<li><p><a class="reference internal" href="#json-non-structure" id="id4">Json Non structuré</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#weblinks" id="id5">Weblinks</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr class="docutils" />
<section id="parsing-json-unstructured-json">
<h2><a class="toc-backref" href="#sommaire" role="doc-backlink">parsing json : unstructured json</a><a class="headerlink" href="#parsing-json-unstructured-json" title="Lien permanent vers cette rubrique">¶</a></h2>
<p>Un json non structuré n’a pas forcément la même clé principale contrairement à un json structuré
qui comprend toujours les mêmes clés. Il est donc important de pouvoir parcourir le json de façon
dynamique.</p>
<section id="json-structure">
<h3><a class="toc-backref" href="#sommaire" role="doc-backlink">Json Structuré</a><a class="headerlink" href="#json-structure" title="Lien permanent vers cette rubrique">¶</a></h3>
<blockquote>
<div><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;merlin&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;metiers&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enchanteur&quot;</span>
<span class="p">},</span>
<span class="p">{</span><span class="w">   </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Arthur&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;metier&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;roi&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="json-non-structure">
<h3><a class="toc-backref" href="#sommaire" role="doc-backlink">Json Non structuré</a><a class="headerlink" href="#json-non-structure" title="Lien permanent vers cette rubrique">¶</a></h3>
<blockquote>
<div><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;merlin&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metier&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enchanteur&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Arthur&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metier&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;roi&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<section id="json-interne">
<h4>Json Interne<a class="headerlink" href="#json-interne" title="Lien permanent vers cette rubrique">¶</a></h4>
<p>Dans ce Snippet, les données json son fournies dirrectement dans le code au travers d’une variable
interne.</p>
<blockquote>
<div><ol class="arabic">
<li><p>On commence par importer les bibliothèques</p>
<blockquote>
<div><p>Seule la bibliothèque « encoding/json » est nécéssaire. la bibliothèque « fmt » n’est utiliée
que pour l’affichage.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;encoding/json&quot;</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>On définit ensuite un struct qui sera utilisé pour la mise en forme des données extraites du
json.</p>
<blockquote>
<div><p>Puisque tous les éléments d’un struct doivent être publique, donc commencer par une
Majuscule, il faut établir une correspondance entre les membres du struct et les clés du
json.</p>
<p>Cette correspondence s’établie en ajoutant : <cite>json: »Nom_de_la_clef »</cite> à la suite de la
déclaration du membre.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span><span class="w"> </span><span class="nx">JsonStruct</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Path</span><span class="w">    </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;path&quot;`</span>
<span class="w">    </span><span class="nx">Exclude</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;exclude&quot;`</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Json Data</p>
<blockquote>
<div><p>Les données Json son fournie manuellement dans une variable.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="c1">// jsonData from a variable</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">jsonData</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">`{</span>
<span class="s">        &quot;Dropbox&quot;: {</span>
<span class="s">            &quot;path&quot;: &quot;/home/polter/Dropbox/WEB/atelier/project/_3_software/Atelier/&quot;,</span>
<span class="s">                &quot;exclude&quot;: [&quot;node_modules/&quot;,&quot;.gitignore&quot;, &quot;build/&quot;]</span>
<span class="s">        },</span>
<span class="s">        &quot;Polux&quot;: {</span>
<span class="s">            &quot;path&quot;:&quot;/home/polter/dev/Atelier/&quot;,</span>
<span class="s">            &quot;exclude&quot;: []</span>
<span class="s">        },</span>
<span class="s">        &quot;Minux&quot;: {</span>
<span class="s">            &quot;path&quot;:&quot;/home/polter/dev/Atelier/&quot;,</span>
<span class="s">            &quot;exclude&quot;: []</span>
<span class="s">            },</span>
<span class="s">        &quot;Labux&quot;: {</span>
<span class="s">            &quot;path&quot;:&quot;&quot;,</span>
<span class="s">            &quot;exclude&quot;: []</span>
<span class="s">        }</span>
<span class="s">    }`</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Fonction “main”</p>
<blockquote>
<div><p>Ici, tout le traitement s’effectue, par facilité, dans la fonction “main”. Les best
practices étant au contraire de travailler le plus possible avec des fonctions et des
modules pour que la fonction “main” soit le plus simple possible et effectue le moins
possible de traitement direct.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// jsonData from a variable</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Création d’un dictionnaire de struct (map[string]struct{})</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/mapOfJsonStruct.svg"><img alt="../../../_images/mapOfJsonStruct.svg" class="align-center" src="../../../_images/mapOfJsonStruct.svg" width="520px" /></a>
<p>« map » permet de créer un dictionnaire. C’est à dire de réunir un ensemble de données sous la
forme Clefs / Valeurs.</p>
<p>Nous créons une variable « config » de type « map ». Ce « map » prendra des clefs de type « string »
et des valeurs de type « JsonStruct ».</p>
<p>Cela signifie qu’une instance du struct « JsonStruct » sera créée pour chaque clefs ajoutées
dans « config ». Dans notre exemple, les clefs seront les clefs primaires du Json (« Dropbox »,
« Polux », « Minux » et « Labux »)</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Creation of a &#39;map&#39; (Dictionary)</span>
<span class="c1">// Keys must be a type &#39;string&#39; and values must be a type &#39;JsonStruct&#39;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">JsonStruct</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Remplissage de “config”</p>
<blockquote>
<div><p>On parcour l’ensemble du fichier json. A Chaque nouvelle entrée dans le Json, on crée une
instance de JsonStruct que l’on rempli avec les données associé à chaque clef primaire.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Unmarshal the json data and send it to the adress (&amp;) of of the map &#39;config&#39;</span>
<span class="c1">// The json Data must be provided as a slice of byte</span>
<span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">jsonData</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">config</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Pour accéder aux dnée de config, peux le parcourrir avec une ou plusieur boucle “for”</p>
<blockquote>
<div><div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;\n/**********/&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;key in &#39;config&#39;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// Check if a key is in the map struct</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">config</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;\nAffichage du &#39;Path&#39; de %v: %v\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">config</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">Path</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nx">isNotEmpty</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">config</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">Exclude</span><span class="p">;</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;\nParcours des elements exclus:&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">exclude</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">config</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">Exclude</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">exclude</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</section>
<section id="json-externe">
<h4>Json Externe<a class="headerlink" href="#json-externe" title="Lien permanent vers cette rubrique">¶</a></h4>
<p>Dans ce Snippet, les données json son fournies depuis un fichier externe. Le code est très similaire
au précédent. La partie de traitement du json a été placée dans une fonction pour facilité la
lecture.</p>
<blockquote>
<div><ol class="arabic">
<li><p>On commence par importer les bibliothèques</p>
<ul class="simple">
<li><p>La bibliothèque « encoding/json » permet de faire les traitement sur les données json.</p></li>
<li><p>La bibliothèque « fmt » est utiliée pour l’affichage d’information pour l’utilisateur.</p></li>
<li><p>La bibliothèque « log » est utilisée pour le traitement des erreurs.</p></li>
<li><p>La bibliothèque « os » est utilisée pour le traitement des fichiers.</p></li>
</ul>
<blockquote>
<div><div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;encoding/json&quot;</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;io&quot;</span>
<span class="w">    </span><span class="s">&quot;log&quot;</span>
<span class="w">    </span><span class="s">&quot;os&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>On définit ensuite un struct qui sera utilisé pour la mise en forme des données extraites du
json.</p>
<blockquote>
<div><p>Puisque tous les éléments d’un struct doivent être publique, donc commencer par une Majuscule,
il faut établir une correspondance entre les membres du struct et les clés du json.</p>
<p>Cette correspondence s’établie en ajoutant : <cite>json: »Nom_de_la_clef »</cite> à la suite de la
déclaration du membre.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span><span class="w"> </span><span class="nx">JsonStruct</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Path</span><span class="w">    </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;path&quot;`</span>
<span class="w">    </span><span class="nx">Exclude</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;exclude&quot;`</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Json Data</p>
<blockquote>
<div><p>Le chemin du fichier json est donné dans la variable “fileName”.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">fileName</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;./computerPathList.json&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Parcour du fichier json</p>
<blockquote>
<div><p>La fonction “getJsonFile” prend en arguement une variable de type “string” cet arguement
correspond au nom du fichier. Elle retourne un “slice” de type “byte”.</p>
<p>Cette fonction contrôle si le fichier existe puis le parcour et le copie en mémoire dans un
tableau de “byte”.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Function to parse the json file</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">getJsonFile</span><span class="p">(</span><span class="nx">fileName</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">byte</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Json Data from an external file</span>
<span class="w">    </span><span class="nx">jsonFile</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="nx">fileName</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="s">&quot;Error when opening file: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Le fichier “jsonFile” sera fermé automatiquement dès que le traitement de ce fichier sera
terminé. Il s’agit d’une fermeture différée (command “defer”).</p>
<p>La bonne pratique est de placer le “defer” juste après l’ouverture du fichier pour être
certain de ne pas l’oublier.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="k">defer</span><span class="w"> </span><span class="nx">jsonFile</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
</pre></div>
</div>
<p>On lit ensuite le fichier jusqu’à la fin et on retourne un “slice” de “byte” : “byteValue”.</p>
<p>N.b : Cette fonction de lecture de fichier peut consommer beaucoup de mémoire en cas de
lecture d’un très gros fichier. Pour la lecture gros fichier, il peut être plus efficace
d’utiliser des fonction de lecture avec un buffer (ex: “ReadAtLeast” ou “ReadFull”).</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Read the file until EOF. The return is a Slice of byte</span>
<span class="w">    </span><span class="nx">byteValue</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">io</span><span class="p">.</span><span class="nx">ReadAll</span><span class="p">(</span><span class="nx">jsonFile</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="s">&quot;Error when reading Data: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">byteValue</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Contrôle de l’éxistance d’une clef dans le “map” de “struct”</p>
<blockquote>
<div><p>La fonction prend en arguement le “map” de “struct” de type “JsonStruct” et un “string” puis
retourne un “boolean”.</p>
<p>L’argument de type « string » correspond au nom de la clef dont ont cherche à vérifier
l’existance dans le struct.</p>
<div class="highlight-Go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Function to check if a key is in the map struct</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">keyInMap</span><span class="p">(</span><span class="nx">refMap</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">JsonStruct</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">refMap</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>La</p>
<blockquote>
<div><dl>
<dt>func main() {</dt><dd><p>byteValue := getJsonFile(fileName)</p>
<p>// Creation of a “map” (Dictionary) of type “JsonStruct”
var config map[string]JsonStruct
// Unmarshal the json data and send it to the adress (&amp;) of of the map “config”
// The json Data must be provided as a slice of byte
json.Unmarshal(byteValue, &amp;config)</p>
<p>fmt.Printf(« Type of “config”: %Tn », config)</p>
<p>isPresent := keyInMap(config, « aaa »)
fmt.Println(« isPresent: « , isPresent)</p>
<p>for key, _ := range config {</p>
<blockquote>
<div><dl>
<dt>if _, ok := config[key]; ok {</dt><dd><dl class="simple">
<dt>if pathIsNotEmpty := config[key].Path; pathIsNotEmpty != «  » {</dt><dd><p>fmt.Println( »n/<strong>******</strong>/ »)
fmt.Println(« key in “config”: « , key)
fmt.Printf( »nAffichage du “Path” de %v: %vn », key, config[key].Path)</p>
</dd>
</dl>
<p>}</p>
<dl>
<dt>if excludeIsNotEmpty := config[key].Exclude; len(excludeIsNotEmpty) != 0 {</dt><dd><p>fmt.Println( »nParcours des elements exclus: »)
for _, exclude := range config[key].Exclude {</p>
<blockquote>
<div><p>fmt.Println(exclude)</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</section>
</section>
</section>
<hr class="docutils" />
<section id="weblinks">
<h2><a class="toc-backref" href="#sommaire" role="doc-backlink">Weblinks</a><a class="headerlink" href="#weblinks" title="Lien permanent vers cette rubrique">¶</a></h2>
</section>
</section>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'20170523',
            LANGUAGE:'fr',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2017, Poltergeist42.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.
        </div>
    </div>  

</body>
</html>